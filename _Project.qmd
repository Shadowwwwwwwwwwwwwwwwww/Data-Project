---
title: "Investigating the Effects of Choice on Mitigating Anxiety"
authors: Ari Astawa, August Gonzales, Saksham Jain, Harry Le, Leo Sharwood, Blake Walker
format:
    html:
        toc: true
        toc-location: right
        toc-title: "Table of Contents"
        toc-depth: 3
        code-fold: true
        code-tools: true
        embed-resources: true
execute:
    warning: false
    message: false
editor: visual
---

```{r}
#| label: setup
library(tidyverse)
library(readxl)
library(gganimate)
library(gifski)
library(plotly)

# Define age groups
agegroup = Vectorize(function(number) {
	if (number >= 16 & number <= 20) {
		return ("16-20")
	} else if (number >= 21 & number <= 25) {
		return ("21-25")
	} else if (number >= 26 & number <= 30) {
		return ("26-30")
	} else if (number >= 31 & number <= 35) {
		return ("31-35")
	} else if (number >= 36 & number <= 40) {
		return ("36-40")
	} else {
		return ("41+")
    }
})

# Import data
data = read_xlsx("all_data.xlsx", sheet = "pooled123") |>
    mutate(choice = recode(choice, CHOICE = "Choice", NO_CHOICE = "No Choice")) |> 
    mutate(ageset = agegroup(age)) |> 
    filter(ageset != "41+")
# Combine choice and environment as single variable
data$choice_and_env = paste(data$choice, "-", data$env)
```

# Abstract

Mitigating anticipatory anxiety is always a desirable outcome. Considering the frequency of anxiety-inducing events in daily life, it is worth investigating whether decision making ability can reduce negative emotional responses. This report finds that choice has no significant role in managing anxiety that precedes activities with perceived displeasure.

# Initial Data Analysis

-   The data was sourced from an experimental survey examining 337 participants on choice and socially acquired nocebo effects in Virtual Reality (VR) (Saunders, 2023).

-   In general, the dataset was well structured and documented with sound integrity.

-   This investigation has a unique focus on anxiety. Variables of Choice, VR Environment, VR Anxiety (Level), Baseline/Active/Delta Anxiety, and Age were all considered.

    -   Age was reclassified from quantitative continuous to qualitative nominal to lessen impact of uneven sample size.

-   A new variable of a combination of Choice and VR Environment was created to aide in graphing.

-   This dataset and analysis is only somewhat limited by the sample size. We assume the three separate runs of the experiment were methodologically consistent across the pooled dataset.

-   Minor data cleaning was performed to exclude age groups outside 16-40 years old to be more representative of the targeted survey bloc.

-   The decision to turn age into a qualitative nominal variable was undertaken in order to remedy the inconsistent distribution of ages.

-   Minor discrepancies in the dataset regarding variable names and descriptions were found. The definitions of `p_e` and `p_stai` were swapped in the data dictionary, verified by calculations.

# Analysis

::: panel-tabset
## Δ VR Anxiety vs. Choice & Environment, Separation by Age Ranges

```{r}
#| label: ce-vranx-age

ce_vranx_age_plot = ggplot(data, aes(x = choice_and_env, y = vranxiety, color = choice, fill = env)) + 
    geom_boxplot() + 
    labs(title = "Δ VR Anxiety vs. Choice & Environment by Age Ranges {closest_state}",
         x = "Choice Given & VR Environment",
         y = "Δ VR Anxiety",
         color = "Choice Given",
         fill = "VR Environment") +
    scale_fill_manual(values=c("lightblue", "orange")) +
    scale_colour_manual(values=c("chartreuse4", "brown3")) +
    transition_states(ageset, transition_length = 1, state_length = 5, wrap = FALSE) +
    enter_fade() + 
    exit_shrink() + 
    ease_aes('exponential-in-out')

animate(ce_vranx_age_plot, renderer = gifski_renderer(), duration = 20)
```

## Δ VR Anxiety vs. Choice & Environment, No Separation by Age Ranges

```{r}
#| label: ce-vranx-noage
ce_vranx_noage_plot = ggplot(data, aes(x = choice_and_env, y = vranxiety, color = choice, fill = env)) + 
    geom_boxplot() + 
    labs(title = "Δ VR Anxiety vs. Choice & Environment",
         x = "Choice Given & VR Environment",
         y = "Δ VR Anxiety",
         color = "Choice Given",
         fill = "VR Environment") +
    scale_fill_manual(values=c("lightblue", "orange")) +
    scale_colour_manual(values=c("chartreuse4", "brown3"))

ggplotly(ce_vranx_noage_plot)
```

## Choice Only and Environment Only

```{r}
#| label: separate-ce-vranx

# ONLY Δ VR Anxiety vs. Choice
choice_plot = ggplot(data, aes(x = choice, y = vranxiety, color = choice)) +
    labs(x = "Choice Given", 
         y = "Δ VR Anxiety", 
         color = "Choice Given") +
    geom_boxplot() +
    scale_colour_manual(values=c("chartreuse4", "brown3"))

# ONLY Δ VR Anxiety vs. Environment
env_plot = ggplot(data, aes(x = env, y = vranxiety, fill = env)) +
    labs(x = "VR Environment", 
         y = "Δ VR Anxiety", 
 	 fill = "VR Environment") +
    geom_boxplot() +
    scale_fill_manual(values=c("lightblue", "orange"))

ggplotly(choice_plot)
ggplotly(env_plot)
```
:::

Our analysis found that there was little relationship between the ability to choose *nor* the VR environment to the change in level of anxiety (henceforth, change will be denoted by $\Delta$). However, it is notable that the range of $\Delta_{\mathrm{VR~Anxiety}}$ and $\Delta_{\mathrm{State~Anxiety}}$ for those experiencing a sunny environment was somewhat greater than those with a snowy environment. This is likely to be a result of natural variation with a low chance for an underlying mechanism for this phenomenon.

The data finds that the mean in participants who were given the ability to choose was `r mean(filter(data, data$choice == "Choice")$vranxiety) # ≈ 2.096` compared to `r mean(filter(data, data$choice == "No Choice")$vranxiety) # ≈ 1.955446` for those who did not. As there is only a slight difference, we demonstrate that choice has little to no bearing on the amount of anxiety a person gains/releases with regards to an activity that may cause distress or other side effects such as cybersickness.

```{r}
#| label: bvra-pvra
vranxiety_cor = cor(data$PVRA, data$BVRA)

bvra_pvra_plot = ggplot(data, aes(x = BVRA, y = PVRA)) +
    geom_point() +
    geom_smooth(method = "lm") +
    geom_abline(intercept = 0, slope = 1) +
    labs(title = "Baseline VR Anxiety Rating vs. Active VR Anxiety Rating",
         subtitle = paste("r =", vranxiety_cor),
         x = "Baseline VR Anxiety Rating",
         y = "Active VR Anxiety Rating")

ggplotly(bvra_pvra_plot) %>%
    layout(title = list(text = paste("Active VR Anxiety Rating vs. Baseline VR Anxiety Rating",
                                    "<br><sup>",
                                    paste("r =", vranxiety_cor),
                                    "</sup>")))
```

```{r}
#| label: bstai-pstai

stai_cor = cor(data$p_stai, data$baseline_stai)

bstai_pstai_plot = ggplot(data, aes(x = baseline_stai, y = p_stai)) +
    geom_point() +
    geom_smooth(method = "lm") +
    geom_abline(intercept = 0, slope = 1) +
    labs(title = "Active State Anxiety Rating vs. Baseline State Anxiety Rating",
         subtitle = paste("r =", stai_cor),
         x = "Baseline STAI-6 Sum Score",
         y = "Active STAI-6 Sum Score")

ggplotly(bstai_pstai_plot) %>%
    layout(title = list(text = paste("Active State Anxiety Rating vs. Baseline State Anxiety Rating",
                                    "<br><sup>",
                                    paste("r =", stai_cor),
                                    "</sup>")))
```

Further analysis shows that participants—ones with minimal VR experience—, typically had increases in both state and VR related anxiety levels[^1]; the majority of people had positive $\Delta_{\mathrm{VR~Anxiety}}$ and $\Delta_{\mathrm{State~Anxiety}}$ scores. Interestingly, the linear model of initial to active anxiety levels shows that participants reporting lower initial scores often had the largest positive deltas. Conversely, people reporting higher initial scores generally had smaller increases, indicated by the modelled line converging with $y = x$. It is worth considering how ignorance/ambivalence towards the activity (despite nocebo priming) may contribute to elevated anxiety levels afterwards.

[^1]: See Appendix for graphs

This, and other literature, suggest that reducing anxiety through enabling user agency is not the correct approach. As a response to both tangible and foreseen events, more effective approaches have been proposed, like by dispelling untrue notions (Huff, 2025). In this case, informative explanations of the activity would be more useful in reducing anxiety (Grupe & Nitschke, 2013). Furthermore, it may be detrimental to indulge in choice-making which encourages symptomatic behaviours, especially as decision making is hampered under anxiety (Engelmann et al., 2015).

# Conclusion

The ability to choose does not have any noticeable affect on the level of anxiety experienced in anticipation of a negative experience. When comparing the results of $\Delta_{\mathrm{VR~Anxiety}}$ and $\Delta_{\mathrm{State~Anxiety}}$, there is no significant difference between chosen and assigned VR environment groups. Our analysis finds that overall, there is a general increase in anxiety, both state and VR related after the experience, and that anxiety becomes more pronounced in participants who felt less unease beforehand. This, along existing literature, indicates that empowerment through information lessens anxiety based on the notion that anxiety is a physiological response to negative stimuli, both perceived and tangible.

# Professional Standard of Report

Throughout the report every member maintained respect for each others privacy, and confidentiality along with professionalism, letting each other do their own dedicated work towards our data story. Additionally, ethical principles were obeyed, with truthfulness and integrity of our work progress, keeping everyone accountable for their own actions.

------------------------------------------------------------------------

# References & Acknowledgements

## References

Alex. (2020, December 7). How to hide import messages when importing a library? \[Forum post\]. Stack Overflow. [https://stackoverflow.com/q/65189127]()

Ben. (2020, December 7). Answer to ‘How to hide import messages when importing a library?’ \[Online post\]. Stack Overflow. [https://stackoverflow.com/a/65189295]()

Embedding from Other Documents. (n.d.). Quarto. Retrieved 10 April 2025, from [https://quarto.org/docs/authoring/notebook-embed.html]()

Engelmann, J. B., Meyer, F., Fehr, E., & Ruff, C. C. (2015). Anticipatory Anxiety Disrupts Neural Valuation during Risky Choice. The Journal of Neuroscience, 35(7), 3085–3099. [https://doi.org/10.1523/JNEUROSCI.2880-14.2015]()

Girondini, M., Stefanova, M., Pillan, M., & Gallace, A. (2023). The Effect of Previous Exposure on Virtual Reality Induced Public Speaking Anxiety: A Physiological and Behavioral Study. Cyberpsychology, Behavior, and Social Networking, 26(2), 127–133. [https://doi.org/10.1089/cyber.2022.0121]()

goollan. (2019, April 30). How do I keep my subtitles when I use ggplotly() \[Forum post\]. Stack Overflow. [https://stackoverflow.com/q/55923256]()

Grupe, D. W., & Nitschke, J. B. (2013). Uncertainty and Anticipation in Anxiety. Nature Reviews. Neuroscience, 14(7), 488–501. [https://doi.org/10.1038/nrn3524]()

Huff, C. (2025, January 16). Are you suffering from anticipatory anxiety? Here’s how to cope. American Psychology Association. [https://www.apa.org/monitor/2025/06/anticipatory-anxiety]()

Includes. (n.d.). Quarto. Retrieved 10 April 2025, from [https://quarto.org/docs/authoring/includes.html]()

Kwon, C. (2020). The Effect of the Degree of Anxiety of Learners during the Use of VR on the Flow and Learning Effect. Applied Sciences, 10(14), Article 14. [https://doi.org/10.3390/app10144932]()

Salazar, M. (2020, April 17). Answer to ‘How do I keep my subtitles when I use ggplotly()’ \[Online post\]. Stack Overflow. [https://stackoverflow.com/a/61277897]()

Saunders, C., Colagiuri, B., & Barnes, K. (2023). Socially Acquired Nocebo Effects Generalize but Are Not Attenuated by Choice. Annals of Behavioral Medicine: A Publication of the Society of Behavioral Medicine, 57(12), 1069–1080. [https://doi.org/10.1093/abm/kaad056]()

## Acknowledgements

This report did **NOT** employ the use of Artificial Intelligence (AI).

## Meetings and Contributions

+------------------------+---------------------------------------------------------------------------------+------------------------+
| Meeting Date           | Purpose                                                                         | People & Contributions |
+========================+=================================================================================+========================+
| 2025/03/19 20:00-21:00 | -   Project planning                                                            | -   Harry              |
|                        |                                                                                 |                        |
|                        | -   Task delegation                                                             | -   August             |
|                        |                                                                                 |                        |
|                        | -   Setting up file sharing                                                     | -   Leo                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Blake              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Ari                |
+------------------------+---------------------------------------------------------------------------------+------------------------+
| 2025/03/20 10:00-12:00 | -   Deliberated on our research question. Considered VR Anxiety and Environment | -   Harry              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   August             |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Leo                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Blake              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Ari                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Shaksham           |
+------------------------+---------------------------------------------------------------------------------+------------------------+
| 2025/03/27 10:00-12:00 | -   Worked on our individual parts                                              | -   Harry              |
|                        |                                                                                 |                        |
|                        | -   Graph generation and discussion of what the graphs revealed                 | -   August             |
|                        |                                                                                 |                        |
|                        | -   Debugging and ensuring methodology/analysis was correct and error free      | -   Leo                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Blake              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Ari                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Shaksham           |
+------------------------+---------------------------------------------------------------------------------+------------------------+
| 2025/03/28 20:00-21:00 | -   Project planning                                                            | -   Harry              |
|                        |                                                                                 |                        |
|                        | -   Discussion of data analysis                                                 | -   August             |
|                        |                                                                                 |                        |
|                        | -   Confirmation of progress                                                    | -   Leo                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Blake              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Ari                |
+------------------------+---------------------------------------------------------------------------------+------------------------+
| 2025/04/03 10:00-12:00 | -   Worked on our individual parts                                              | -   Harry              |
|                        |                                                                                 |                        |
|                        | -   Progress check-in                                                           | -   August             |
|                        |                                                                                 |                        |
|                        | -   Confirmation of submission requirements                                     | -   Leo                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Blake              |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Ari                |
|                        |                                                                                 |                        |
|                        |                                                                                 | -   Shaksham           |
+------------------------+---------------------------------------------------------------------------------+------------------------+

------------------------------------------------------------------------

# Appendix

```{r}
#| label: ce-stai-age
ce_stai_age_plot = ggplot(data, aes(x = choice_and_env, y = stai, color = choice, fill = env)) + 
    geom_boxplot() + 
    labs(title = "Δ State Anxiety Level vs. Choice & Environment by Age Ranges {closest_state}",
         x = "Choice Given & VR Environment",
         y = "Δ STAI-6 Sum Score",
         color = "Choice Given",
         fill = "VR Environment") +
    scale_fill_manual(values=c("lightblue", "orange")) +
    scale_colour_manual(values=c("chartreuse4", "brown3")) +
    transition_states(ageset, transition_length = 1, state_length = 5, wrap = FALSE) +
    enter_fade() + 
    exit_shrink() + 
    ease_aes('exponential-in-out')

animate(ce_stai_age_plot, renderer = gifski_renderer(), duration=20)
```

```{r}
#| label: ce-stai-noage
ce_stai_noage = ggplot(data, aes(x = choice_and_env, y = stai, color = choice, fill = env)) +
    geom_boxplot() +
    labs(title = "Δ State Anxiety Level vs. Choice & Environment",
         x = "Choice Given & VR Environment",
         y = "Δ STAI-6 Sum Score",
         color = "Choice Given",
         fill = "VR Environment") +
    scale_fill_manual(values=c("lightblue", "orange")) +
    scale_colour_manual(values=c("chartreuse4", "brown3"))

ggplotly(ce_stai_noage)
```

```{r}
#| label: separate-ce-stai

# Δ State Anxiety Level vs. ONLY Choice
choice_plot = ggplot(data, aes(x = choice, y = stai, color = choice)) +
    labs(
        title = "Δ State Anxiety Level vs. Choice Given",
        x = "Choice Given",
        y = "Δ STAI Level",
        color = "Choice Given") +
    geom_boxplot() +
    scale_colour_manual(values=c("chartreuse4", "brown3"))

# ONLY Δ State Anxiety Level vs. VR Environment
env_plot = ggplot(data, aes(x = env, y = stai, fill = env)) +
    labs(
        title = "Δ State Anxiety Level vs. VR Environment",
        x = "VR Environment",
        y = "Δ STAI Level",
        fill = "VR Environment") +
    geom_boxplot() +
    scale_fill_manual(values=c("lightblue", "orange"))

ggplotly(choice_plot)
ggplotly(env_plot)
```

```{r}
#| label: bvra-pvra-resid
vranxiety_model = lm(PVRA ~ BVRA, data = data)

# Appendix A: Residual Plot
bvra_pvra_resid_plot = ggplot(vranxiety_model, aes(x = .fitted, y = .resid)) +
    geom_point() +
    geom_hline(yintercept = 0) +
    labs(title = "PVRA vs. BVRA Residual Plot",
         x = "Predicted Values",
         y = "Error")

ggplotly(bvra_pvra_resid_plot)
```

```{r}
#| label: bstai-pstai-resid
stai_model = lm(p_stai ~ baseline_stai, data = data)

# Appendix B: Residual Plot
bstai_pstai_resid_plot = ggplot(stai_model, aes(x = .fitted, y = .resid)) +
    geom_point() +
    geom_hline(yintercept = 0) +
    labs(title = "P-STAI-6 Sum Score vs. B-STAI-6 Sum Score Residual Plot",
         x = "Predicted Values",
         y = "Error")

ggplotly(bstai_pstai_resid_plot)
```
