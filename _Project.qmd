---
title: "But A Mere, Simple Quarto File"
authors: Blake Walker, Leo, Ari, August Gonzales, Harry Le
format:
    html:
        embed-resources: true
editor: visual
---

STILL NEED TO EMBED DATA PROPERLY INTO THE DOCUMENT

```{r setup, echo=FALSE, warning=FALSE, message=FALSE, include = FALSE}
library(tidyverse)
library(ggplot2)
library(plotly)
library(readxl)
library(dplyr)

file_path <- "all_data.xlsx"
all_data <- read_excel("all_data.xlsx", sheet = "pooled123")

```

## Executive Summary

Our analysis within this report found that typically there was a higher median in anxiety level change for those who had a snowy environment, then there were for those whom experienced a sunny environment. Although, notably the range for change in anxiety for those with a sunny environment was much greater than those with a snowy environment, indicating a that there may only be a small correlation between environments. Moreover, the analysis conveyed that the spreads of the data decreased for both environments when given the choice to choose, although the IQR remained similar. As such the environment the user experiences has little association with the change in anxiety, although when given a choice a more decisive result may occur.

## Initial Data Analysis

Max 200 words: Discusses source, structure and limitations of data collection. Defines meaning of key variables. Describes any assumptions, and any data cleaning.

1.  Source' means where the data came from.

2.  'Structure' means the overall size of the dataset, and the type of variables, including any reclassification needed in R. You can focus on just the variables needed for your research questions.

3.  'Limitations' means the issues which may affect confidence in and interpretation of the data.

4.  'Assumptions' is any ideas about the data for which we don't yet have evidence. For example, you collect 100 students shoe sizes, 90 students shoe size range between 6-12 but 10 are outliers at 30 - 45. You may make the assumption that they have incorrectly entered european sizes.

5.  'Data cleaning' is changing the data from its original format. You do not need to list every change (eg change of classification can be noted in the code chunk), rather discuss the overall nature of changes with reasons.

**Overview**

The data was sourced through an experimental testing. (WHERE IT COMES FROM)

Our investigation has a unique focus on age groups within the experiments, and how a VR environment may cause a impact on the fluctuation of the participants anxiety reported levels. With these three variables we had to reclassify age from a quantitative continuous variable into a qualitative nominal to utilize the ages as groups for which the anxiety changed, while the rest remained as they were. These being the VR environment as a qualitative nominal, and the anxiety level's which is a quantitative discrete variable.

```{r}
# I think this is correct for the graph, for the change in anxiety I dunno. It also shows that a sunny environment may have not as large of an affect in anxiety compared to snowy, Although notable the Simpsons affect might take affect here as the min and max for sunny is normally higher which means that their increase or decrease in anxiety might make it seem like theres not as big of an affect. (Median is always equal to or less than) ALSO NOTE: This may not be the best way, as we only know the change E.g Final - Intial, ALSO THIS IS CHANGE, LOWER ONLY MEANS A LOWER CHANGE NOT REDUCED ANXIETY.

all_data <- all_data %>%
  mutate(change_in_anxiety = p_vra - baseline_vra,  # Calculate the change in anxiety
         age_group = cut(age, 
                          breaks = c(15, 20, 25, 30, 35, 40), 
                          labels = c("15-20", "20-25", "25-30", "30-35", "35-40"),
                          right = FALSE))  # Create the age groups

# Filter out outliers for change in anxiety (below 0 or above 5)
all_data_clean <- all_data %>%
  filter(change_in_anxiety >= -4 & change_in_anxiety <= 10)  # Remove rows where change in anxiety is below 0 or above 5

# Create the boxplot with the desired y-axis scale using the change in anxiety
p <- ggplot(all_data_clean, aes(x = env, y = change_in_anxiety, fill = env)) +
  geom_boxplot(na.rm = TRUE) +  # Ensure that missing values don't break the plot
  facet_wrap(~ age_group) +  # Separate by age groups
  labs(title = "Change in Anxiety Levels by System Environment and Age Group",
       x = "System Environment",
       y = "Change in Anxiety Level",
       fill = "Environment") +
  theme_minimal() +
  scale_y_continuous(limits = c(-5, 10), 
                     breaks = seq(-4, 10, by = 2))  # Y-axis ticks every 2 units

# Convert the plot to an interactive plot
ggplotly(p)
```

```{r, fig.height=40, fig.width=20}
# This graph shows that when given a choice, the max and mins become a lot closer to the quatiles, hence less outliers in the data. Although it is notable that the median change of anxiety does not change that much so they still experience similar amounts of change. NOTE: LOOK AT HTML FOR FULL VIEW

all_data <- all_data %>%
  mutate(change_in_anxiety = p_vra - baseline_vra,  # Calculate the change in anxiety
         age_group = cut(age, 
                          breaks = c(15, 20, 25, 30, 35, 40), 
                          labels = c("15-20", "20-25", "25-30", "30-35", "35-40"),
                          right = FALSE))  # Create the age groups

# Filter out outliers for change in anxiety (below 0 or above 5)
all_data_clean <- all_data %>%
  filter(change_in_anxiety >= -4 & change_in_anxiety <= 10)  # Remove rows where change in anxiety is below 0 or above 5


# Now, create the faceted boxplot with the two sections:
# One for participants who chose their environment, 
# and one for participants who did not choose their environment

p <- ggplot(all_data_clean, aes(x = env, y = change_in_anxiety, fill = env)) +
  geom_boxplot(na.rm = TRUE) +  # Ensure that missing values don't break the plot
  facet_wrap(~ choice + age_group, ncol = 1) +  # Facet by choice condition and age group
  labs(title = "Change in Anxiety Levels by System Environment",
       x = "System Environment",
       y = "Change in Anxiety Level",
       fill = "Environment") +
  theme_minimal() +
  scale_y_continuous(limits = c(-10, 10), 
                     breaks = seq(-5, 10, by = 5)) +  # Y-axis ticks every 2 units
  theme(strip.text = element_text(size = 10),  # Adjust facet label size
        strip.background = element_blank(),  # Remove background color from facet labels
        panel.spacing = unit(2, "lines"),  # Increase spacing between panels
        axis.text.y = element_text(size = 12, angle = 0, hjust = 1),  # Increase size and adjust angle of y-axis labels
        axis.title.y = element_text(size = 14),  # Increase the size of y-axis title
        axis.text.x = element_text(size = 10))  # Adjust x-axis label size

# Convert the plot to an interactive plot and increase vertical size with margin adjustments
ggplotly(p) %>%
  layout(height = 1000,  # Adjust the height further
         margin = list(l = 100, r = 100, t = 100, b = 100)) 
```

-   

-   **Limitations**

    Within the data not a full population could be used, this entails that the experiment will not be able to get perfectly accurate results. Furthermore, it is not possible to control people's moods and behaviors before entering the VR simulation, as such the data could vary depending on the sets of groups used.

    **Assumption**

    There is an assumption that people were honest with their symptoms, and variation in anxiety levels throughout the experiment. Along with having any non permitted knowledge on how the test is conducted beyond what has been told to the participants. Furthermore, it is assumed that neither the conductors or participants had any bias on the data, whether it be more stable data or a greater change in symptoms. Moreover, it is assumed the test were completed in the same way, so no co-founding variables would have altered the data sets. Furthermore, data cleaning had to take place to remove outliers, these were anxiety levels that were less than zero or more than 5, as the levels only ranged in between these as such it was assumed to be a mistake if it was outside this range. (ADD ANYTHING ELSEABOUT CLEANING THE DATA(E.G REMOVING CERTAIN AGE GROUPS)

## Research Question

Explores a research question, using numerical and/or graphical summaries (i.e., ggplot, gganimation, maps) which give insight.

You have freedom to approach this task however you'd like to. You will be marked on whether you 'skillfully dealt with the research data.'

Overall: 1. The total word count is 350 words. 2. Coding and R output is not included in the word count.

Findings(REMOVE AFTER): The environment has little to no correlation with anxiety impact. People with higher initial tend to see the biggest reductions. Choice seems to change anxiety a little bit, although more noticeably the end result is more similar to the start (Max and mins shrink closer to quartiles).

Q\) Does the volition on the type of VR environment impact the severity of anxiety level deviation

The data conveyed that the change in anxiety level between users of sunny, and snowy environments varied by minuscule amounts. This is shown in the median, mean, and quartiles of the data, where the average median among all age groups of sunny and snowy environments was a change of 1.4 anxiety levels and 1.6 respectively, revealing that snowy environments had a slightly higher change. Furthermore, the average range of Q1, and Q3 was 3.6 for sunny environments, and 3.1 for snowy, implying that the snowy environments narrower IQR may be a resultant of a slightly more decisive, consistent and reduced overall change in anxiety, where fewer users deviate from their original anxiety score. Both the change in median, and IQR range indicate that only a small, possibly non exisitent correlation can be made between environments having an affect on the overall change in anxiety, and the predicted outcome towards any user.

Our findings conclude that there may be an influence on change in anxiety levels due to the systems environments, although due to the tendency of the average data to remain within a whole number, it is not possible to determine a exact correlation.

## Professional Standard of Report

1\. The report is well edited with a high standard of spelling and grammar. 2. The word counts are respected, and there is no extraneous output. 3. The research is interesting, and carefully and thoughtfully implemented. 4. There is a short statement explaining how 1 of the Shared Values and 1 of the Ethical Principles has been adhered to (see ISI: <https://isi-web.org/declaration-professional-ethics>)

------------------------------------------------------------------------

## References & Acknowledgements

Max 50 words: Carefully relates findings to 2 articles (can be research or media etc). Articles are listed in the References at the end, using APA.\

1.  See APA information here: <https://libguides.library.usyd.edu.au/citation/apa7>
2.  The references are not included in the word count.
3.  The comments on articles can be put in a separate section, or weaved throughout the report, at appropriate places.

The report ends with an 'Acknowledgments' section. The Acknowledgment section includes:\

-   a list of group meetings (date and time and attendance) - the contribution of each group member

{{< include "Meetings and Contributions.qmd" >}}

-   all resources used (eg url of stack overflow, url of Ed post, date and details of drop-in session with tutor)

{{< include "Acknowledgements and Resources.qmd" >}}

-   an AI usage statement explaining how AI was used, the name and version of AI tools used, the date/s of use of the AI tools and a link to the entire prompt session used to inform the report. If no AI was used, this must be made explicit.
