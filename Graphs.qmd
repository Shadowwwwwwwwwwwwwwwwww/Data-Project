---
title: "Graphs"
format:
    html:
        embed-resources: true
---

```{r}
install.packages("tidyverse")
library(tidyverse)
install.packages("readxl")
library(readxl)
<<<<<<< HEAD
install.packages("gganimate")
library(gganimate)
install.packages("gifski")
library(gifski)
install.packages("dplyr")
library(dplyr)

agegroup = Vectorize(function(number) {
	if (number >= 17 & number <= 20) {
		return ("17-20")
	} else if (number >= 21 & number <= 25) {
		return ("21-25")
	} else if (number >= 26 & number <= 30) {
		return ("26-30")
	} else if (number >= 31 & number <= 35) {
		return ("31-35")
	} else if (number >= 36 & number <= 40) {
		return ("36-40")
	} else {
		return ("41+")
    }
})

data = read_xlsx("all_data.xlsx", sheet = "pooled123") |>
    mutate(choice = recode(choice, CHOICE = "Choice", NO_CHOICE = "No Choice")) |> 
    mutate(ageset = agegroup(age)) |> 
    filter(ageset != "41+")
data$choice_and_env = paste(data$choice, "-", data$env)

(ggplot(data, aes(x = choice_and_env, y = vranxiety, color = choice, fill = env)) + 
    geom_boxplot() + 
    labs(x = "Choice and Environment", y = "Change in Anxiety Level", color = "Choice", fill = "Environment") + 
    ggtitle("Change in Anxiety Level Against Choice and Environment from Ages {closest_state}") +
    transition_states(ageset, state_length = 3, wrap = FALSE) + 
    enter_fade() + 
    exit_shrink() + 
    ease_aes('exponential-in-out') +
    scale_fill_manual(values=c("lightblue", "orange")) +
    scale_colour_manual(values=c("chartreuse4", "brown3"))) |>
    animate(renderer = gifski_renderer())
=======
library(gganimate)
library(gifski)
>>>>>>> 0b56032 (Upload graphs)




ggplot(data, aes(x = choice, y = vranxiety)) +
    geom_boxplot()

ggplot(data, aes(x = env, y = vranxiety)) +
    geom_boxplot()



anxiety_model = lm(active_ssq_full ~ baseline_ssq_full, data = data)

ggplot(data, aes(x = baseline_ssq_full, y = active_ssq_full)) +
    geom_point() +
    geom_smooth(method = "lm")

ggplot(anxiety_model, aes(x = .fitted, .resid)) +
    geom_point() +
    geom_hline(yintercept = 0)

ggplot(data, aes(x = ssq_full)) +
    geom_boxplot()

<<<<<<< HEAD


vranxiety_model = lm(pvra ~ bvra, data = data)

ggplot(data, aes(x = bvra, y = pvra)) +
    geom_point() +
    geom_smooth(method = "lm")

ggplot(anxiety_model, aes(x = .fitted, .resid)) +
    geom_point() +
    geom_hline(yintercept = 0)

ggplot(data, aes(x = vranxiety)) +
    geom_boxplot()
=======
ageset = function(number) {
	if (age >= 17 & age <= 20) {
		return ("ageset1")
	} else if (age >= 21 & age <= 25) {
		return ("ageset2")
	} else if (age >= 26 & age <= 30) {
		return ("ageset3")
	} else if (age >= 31 & age <= 35) {
		return ("ageset4")
	} else if (age >= 36 & age <= 40) {
		return ("ageset5")
	}
}
data |> mutate(ageset = ageset(data$age))
plot = ggplot(data, aes(x = choice_and_env, y = vranxiety)) + geom_point()+ labs(x = "Choice and Environment", y = "Change in Anxiety Level") + transition_states(ageset, transition_length = 1, state_length = 1)

>>>>>>> 0b56032 (Upload graphs)
```
